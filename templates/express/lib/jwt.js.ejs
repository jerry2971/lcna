<% if(flow){ %>// @flow
<% } %>const jwt = require('jsonwebtoken');

const SECRET<% if(flow){ %>: string<% } %> = 'SECRET';
const option = {
  expiresIn: '1h' // '60ms', '2 days', '10h', '7d'
};

const jwtSign = (body<% if(flow){ %>: any<% } %>) => {
  return jwt.sign(body, SECRET, option);
};

const jwtVerify = (token<% if(flow){ %>: string<% } %>, callback<% if(flow){ %>: (err: {
  name: string,
  message: string,
  expiredAt: number
}, decoded: any) => void<% } %>) => {
  jwt.verify(token, SECRET, callback);
};

module.exports = {
  jwtSign,
  jwtVerify
};
  